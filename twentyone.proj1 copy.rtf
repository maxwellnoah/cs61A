{\rtf1\ansi\ansicpg1252\cocoartf1138\cocoasubrtf510
{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
\margl1440\margr1440\vieww10800\viewh13160\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural

\f0\fs24 \cf0 ;;;;;;;;;;\
(define (best-total sent)\
	(ace-total-helper (aces-counter sent) (total-helper sent)))\
\
(define (ace-total-helper aces-counter value)\
	(if\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural
\cf0 	(and (>= value 22) (>= aces-counter 1))\
	(ace-total-helper (- aces-counter 1) (- value 10))\
	value))\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural
\cf0 \
(define (aces-counter sent)\
	(cond\
	((empty? sent) 0)\
	((equal? (first (first sent)) 'a) (+ 1 (aces-counter (bf sent))))\
	(else (aces-counter (bf sent)))))\
\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural
\cf0 (define (total-helper sent)\
	(if\
	(empty? sent)\
	0\
	(+ (value-helper (first sent)) (total-helper (bf sent)))))\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural
\cf0 	\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural
\cf0 (define (value-helper wrd)\
	(cond\
	((equal? (first wrd) 'a) 11)\
	((equal? (first wrd) 'k) 10)\
	((equal? (first wrd) 'q) 10)\
	((equal? (first wrd) 'j) 10)\
	((equal? (first wrd) '1) 10)\
	((equal? (first wrd) 9) 9)\
	((equal? (first wrd) 8) 8)\
	((equal? (first wrd) 7) 7)\
	((equal? (first wrd) 6) 6)\
	((equal? (first wrd) 5) 5)\
	((equal? (first wrd) 4) 4)\
	((equal? (first wrd) 3) 3)\
	((equal? (first wrd) 2) 2)\
	(else (error "error message"))))\
\
;;;;;;\
(define (stop-at-17 customer-hand-so-far dealer-up-card)\
	(if\
	(<= (best-total customer-hand-so-far) 17)\
	#t\
	#f))\
\
;;;;;;\
(define (play-n strategy n)\
	(cond\
	((= n 0) 0)\
	((twenty-one strategy\
\
\
(define (play-n n)\
	(lambda (strategy) (customer-hand-so-far dealer-up-card))\
\
\
\
;;;;;;;;;\
(define (dealer-sensitive customer-hand-so-far dealer-up-card)\
	(if\
	(or\
	(and (< (best-total customer-hand-so-far) 17) (>= (best-total dealer-up-card) 7))\
	(and (< (best-total customer-hand-so-far) 12) (<= (best-total dealer-up-card) 6)))\
	#t\
	#f))\
;;;;;;;;;\
(define (stop-at n customer-hand-so-far dealer-up-card)\
	(if\
	(<= (best-total customer-hand-so-far) n)\
	#t\
	#f\
\
;;;;;;;;;;\
(define (valentine customer-hand-so-far dealer-up-card)\
	(if\
	(heart? customer-hand-so-far)\
\
\
(define (heart? wrd)\
	(equal? (butlast wrd) 'h))\
\
(define (h-checker? sent)\
	(cond\
	((heart? (first sent)) #t)\
	((\
\
\
(define (h-test sent)\
\
\
\
\
	}